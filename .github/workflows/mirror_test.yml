name: mirrortest

on:
  push:
    branches:
      - ouproj_template

jobs:
  mirror:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout source code
      uses: actions/checkout@v2

    - name: Mirror repository
      run: |
        git clone --mirror https://github.com/rmgpanw/ourproj
        cd ourproj.git
        git config --local user.name "Your Name"
        git config --local user.email "your-email@example.com"

        # Check if remote origin already exists
        REMOTE_ORIGIN_EXISTS=$(git remote -v | grep origin)
        if [ -z "$REMOTE_ORIGIN_EXISTS" ]; then
          git remote add origin https://github.com/{TARGET_OWNER}/{TARGET_REPOSITORY}.git
        fi

        ls -lah

        git push --set-upstream origin main
